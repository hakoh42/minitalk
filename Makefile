# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: hakoh <hakoh@student.42.fr>                +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2019/11/05 10:32:27 by hakoh             #+#    #+#              #
#    Updated: 2021/09/03 17:21:17 by hakoh            ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

# ---------------------------------------------------------------------------- #
############################### PROGRAM NAME ###################################
# ---------------------------------------------------------------------------- #
NAME	=	server
NAME2	=	client

# ---------------------------------------------------------------------------- #
############################### COMPILATION ####################################
# ---------------------------------------------------------------------------- #
CC = clang

# ---------------------------------------------------------------------------- #
################################## FLAGS #######################################
# ---------------------------------------------------------------------------- #
CFLAGS	=	-Wall -Wextra -Werror

# ---------------------------------------------------------------------------- #
################################# INCLUDES #####################################
# ---------------------------------------------------------------------------- #
INCLUDES	= -I $(PATH_INC)				\
			  -I $(PATH_PRINTF)

# ---------------------------------------------------------------------------- #
################################# SOURCES ######################################
# ---------------------------------------------------------------------------- #
SRCS_SERVER = $(addprefix $(PATH_SERVER),	\
			  $(addsuffix .c,				\
			  server))
SRCS_CLIENT =	$(addprefix $(PATH_CLIENT),	\
				$(addsuffix .c,				\
				client))

# ---------------------------------------------------------------------------- #
################################## OBJECTS #####################################
# ---------------------------------------------------------------------------- #
OBJS_SERVER	=	$(SRCS_SERVER:.c=.o)
OBJS_CLIENT	=	$(SRCS_CLIENT:.c=.o)

# ---------------------------------------------------------------------------- #
################################### PATHS ######################################
# ---------------------------------------------------------------------------- #
PATH_INC	=	./inc/
PATH_SERVER	=	./src/server/
PATH_CLIENT	=	./src/client/
PATH_PRINTF =	./ft_printf/

# ---------------------------------------------------------------------------- #
################################# LIBRARIES ####################################
# ---------------------------------------------------------------------------- #
LDFLAGS		= -L$(PATH_PRINTF)
LDLIBS		= -lftprintf

# ---------------------------------------------------------------------------- #
################################### RULES ######################################
# ---------------------------------------------------------------------------- #
all: $(NAME) $(NAME2)

$(NAME): $(OBJS_SERVER)
	$(MAKE) -C $(PATH_PRINTF)
	$(CC) -o $@ $^ $(LDFLAGS) $(LDLIBS)

$(NAME2): $(OBJS_CLIENT)
	$(MAKE) -C $(PATH_PRINTF)
	$(CC) -o $@ $^ $(LDFLAGS) $(LDLIBS)

%.o: %.c
	$(CC) -o $@ -c $< $(CFLAGS) $(INCLUDES)

clean:
	$(MAKE) -C $(PATH_PRINTF) clean
	rm -f $(OBJS_SERVER) $(OBJS_CLIENT)

fclean: clean
	$(MAKE) -C $(PATH_PRINTF) fclean
	rm -rf $(NAME) $(NAME2)

re:	fclean all

# ---------------------------------------------------------------------------- #
################################## OTHER #######################################
# ---------------------------------------------------------------------------- #
.PHONY		: all clean fclean re
